# 교착상태
- 프로세스는 자원을 사용하기 전에 반드시 요청해야 하고, 사용 후에는 반드시 방출해야 한다. 또한, 프로세스는 지정된 태스크를 실행하기 위해 필요한 만큼의 자원을 요청할 수 있다.
- 한 프로세스 집합 내의 모든 프로세스가 그 집합 내의 다른 프로세스에 의해서만 발생될 수 있는 사건을 기다린다면, 그 프로세스 집합은 교착 상태에 있다.

## 교착상태의 특징

### 필요 조건들
- 상호 배제: 최소한 하나의 자원이 비공유 모드로 점유되어야 한다. 비공유 모드에서는 한 번에 한 프로세스만이 그 자원을 사용할 수 있다. 다른 프로세스가 그 자원을 요청하면, 요청 프로세스는 자원이 방출될 때까지 반드시 지연되어야 한다.
- 점유하며 대기: 프로세스는 최소한 하나의 자원을 점유 한채, 현재 다른 프로세스에 의해 점유된 자원을 추가로 얻기 위해 반드시 대기해야한다.
- 비선점: 자원이 강제적으로 방출될 수 없고, 점유하고 있는 프로세스가 태스크를 종료한 후 그 프로세스에 의해 자발적으로만 방출될 수 있다.
- 순환 대기: 대기하고 있는 프로세스의 집합에서 각 프로세스는 서로 다른 프로세스가 가진 자원을 위해서 대기하는 것이다.
- 교착상태가 발생하려면, 앞의 네 가지 조건이 성립되어야 한다.

### 자원 할당 그래프
- 사각형은 자원을 의미하고 원형은 프로세스를 의미한다. 화살표는 자원을 요구한다는 것 요구하는 것을 의미한다. 자원 안에는 점의 자원 인스턴스가 존재한다.
- 그래프가 사이클을 포함하지 않으면 시스템 내 어느 프로세스도 교착상태가 아니라는 것을 보일 수 있다. 만약 그래프에 사이클이 있다면 교착상태가 존재할 수 있다.
- 각 자원 타입이 정확하게 하나의 인스턴스만을 가지면, 하나의 사이클은 교착상태가 발생하였음을 암시한다.
- 사이클이 각각 하나의 인스턴스만 갖는 자원 타입의 집합만을 포함한다면 교착상태가 발생한 것이다. 사이클에 포함된 각 프로세스는 교착상태에 있다.
- 각 자원 타입이 여러개의 인스턴스를 갖는 경우, 사이클은 반드시 교착상태가 발생했음을 의미하지 않는다. 이 경우 그래프 내의 사이클은 교착상태가 존재하는 데 필요 조건이며 충분 조건이 되지는 않는다.
- 자원 할당 그래프에 사이클이 없다면, 시스템은 교착상태가 아니다. 반면에, 사이클이 있다면 시스템은 교착상태일 수도 있고 아닐 수도 있다.

## 교착상태 처리 방법
- 시스템이 결코 교착상태가 되지 않도록 보장하기 위하여 교착상태를 예방하거나 회피하는 프로토콜을 사용한다.
- 시스템이 교착상태가 되도록 허용한 다음에 회복시키는 방법이 있다.
- 문제를 무시하고, 교착상태가 시스템에서 결코 발생하지 않는 척 한다.
- 세 번째 해결안이 UNIX와 Windows를 포함해 대부분의 OS가 사용하는 방법이다. 이 경우 교착상태를 처리하는 프로그램을 작성하는 것은 개발자의 몫이다.
- 교착상태 발생하지 않도록 하기 위해서 시스템은 교착상태 예방 혹은 회피 기법 중 하나를 사용할 수 있다. 
- 교착상태 예방은 교착상태 필요조건들 중 적어도 하나가 성립하지 않도록 보장하는 방법이다. 
- 교착상태 회피는 프로세스가 일생동안 요구하고 사용할 자원에 대한 부가적인 정보를 미리 제공할 것을 요구한다. 이러한 정보로 OS는 각 요청에 대해 그 프로세스가 기다려야 할지 말지를 결정할 수 있다.
- 시스템은 교착상태를 조사하는 알고리즘과 교착상태에 빠졌다면 복구하는 알고리즘을 제공해야 한다.
- 만약 교착상태를 탐지하고 복구하는 알고리즘이 없다면, 탐지되지 않은 교착상태는 실행이 불가능한 프로세스에 의해 자원이 점유되어 잇고, 많은 프로세스들이 자원 요청함에 따라 계속 교착상태로 진입하기 때문에 시스템 성능을 저하시키게 된다. 결국 시스템은 작동을 정지하고, 수작업으로 다시 시작할 필요가 있다.
